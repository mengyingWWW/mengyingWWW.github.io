---
---

/*
 * This file controls what is imported from /_sass
 *
 * Note that the files are processed in the order they are imported, so they are partly
   sorted by the dependencies. Also, the first two lines of the file are required by Jekyll.
 */

@import
    "vendor/breakpoint/breakpoint",

    "themes",
    "theme/{{ site.site_theme | default: 'default' | append: '_light' }}",
    "theme/{{ site.site_theme | default: 'default' | append: '_dark' }}",

    "include/mixins",
    "vendor/susy/susy",

    "layout/reset",
    "layout/base",

    "include/utilities",
    "layout/tables",
    "layout/buttons",
    "layout/notices",
    "layout/masthead",
    "layout/navigation",
    "layout/footer",
    "syntax",

    "layout/forms",

    "layout/page",
    "layout/archive",
    "layout/sidebar",
    "layout/json_cv",

    "vendor/font-awesome/fontawesome",
    "vendor/font-awesome/solid",
    "vendor/font-awesome/brands"
;

/* ===============================
   Custom overrides
   =============================== */

/* Smooth scroll for anchor navigation */
html { scroll-behavior: smooth; }

/* Prevent section titles from being hidden under the sticky header */
section { scroll-margin-top: 6rem; }
section { padding-top: 2.5rem; padding-bottom: 2.5rem; }

/* Hide the theme toggle button (top-right) */
.theme-toggle,
.toggle-theme,
.masthead__menu-item--theme,
#theme-toggle,
button[aria-label*="theme"],
button[title*="theme"],
button[aria-label*="Toggle"] {
  display: none !important;
}

/* ===== Desktop only: keep title left, menu right (don't break mobile dropdown) ===== */
@media (min-width: 769px) {
  .masthead__inner-wrap { max-width: 100%; }
  .masthead__menu { width: 100%; }

  .greedy-nav {
    display: flex;
    align-items: center;
    width: 100%;
  }

  .greedy-nav .visible-links {
    display: flex;
    align-items: center;
    width: 100%;
  }

  /* site title stays left */
  .greedy-nav .visible-links > li.masthead__menu-item--lg {
    margin-right: auto;
  }

  /* spacing */
  .greedy-nav .visible-links > li {
    margin-left: 0.3rem;
    margin-right: 0.3rem;
  }
}

/* ===== Desktop sidebar: remove duplicated name (keep only bio line) ===== */
.sidebar .author__name {
  display: none !important;
}

/* ================================
   Mobile / iPad (<=768px)
   Goals:
   1) dropdown menu not clipped (News not off-screen)
   2) remove Follow button
   3) avatar centered + a bit closer to header
   4) bio centered
   5) Email/GitHub/LinkedIn centered AND remove white box styling
   ================================ */
@media (max-width: 768px) {

  /* --- 1) Fix greedy-nav dropdown width/position --- */
  .greedy-nav { position: relative; }

  .greedy-nav .hidden-links {
    left: 0 !important;
    right: 0 !important;
    width: 100% !important;
    max-width: 100% !important;
    box-sizing: border-box !important;
    padding-left: 16px !important;
    padding-right: 16px !important;
  }

  .greedy-nav .hidden-links a {
    display: block !important;
    white-space: normal !important;
  }

  /* --- 2) Remove Follow button completely --- */
  .author__urls-wrapper button,
  .author__urls-wrapper .btn {
    display: none !important;
  }

  /* --- 3) Center + enlarge avatar (move UP by reducing margin-top) --- */
  .author__avatar {
    float: none !important;
    display: flex !important;
    justify-content: center !important;
    margin: 8px 0 10px 0 !important; /* 关键：让头像离顶栏更近 */
  }

  .author__avatar img {
    width: 170px !important;
    max-width: 170px !important;
    height: auto !important;
    border-radius: 50% !important;
  }

  /* --- 4) Author content layout centered --- */
  .author__content {
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    text-align: center !important;
    padding: 0 12px !important;
  }

  /* Hide duplicated author name on mobile (header already has your name) */
  .author__name { display: none !important; }

  /* bio line centered (MS.HCDE...) */
  .author__bio {
    display: block !important;
    width: 100% !important;
    text-align: center !important;
    margin: 6px auto 10px auto !important;
    font-size: 0.98rem !important;
    opacity: 0.9 !important;
  }

  /* --- 5) Contacts: always visible + centered + remove “white box” --- */
  .author__urls-wrapper {
    display: flex !important;
    justify-content: center !important;
    width: 100% !important;

    max-height: none !important;
    overflow: visible !important;
    background: transparent !important;
    border: 0 !important;
    box-shadow: none !important;
  }

  /* the <ul> that holds the links */
  .author__urls,
  .author__urls.social-icons {
    display: inline-flex !important;
    flex-wrap: wrap !important;
    justify-content: center !important;
    align-items: center !important;
    gap: 10px 18px !important;

    width: auto !important;
    margin: 0 !important;
    padding: 0 !important;

    background: transparent !important;
    border: 0 !important;
    box-shadow: none !important;
  }

  .author__urls li {
    background: transparent !important;
    border: 0 !important;
    box-shadow: none !important;
  }

  .author__urls a {
    background: transparent !important;
    border: 0 !important;
    box-shadow: none !important;
    text-decoration: none !important;
    opacity: 0.95 !important;
  }

  /* 如果还有“白色框/小气泡”，通常来自 focus/outline */
  .author__urls a:focus,
  .author__urls a:active {
    outline: none !important;
  }
}
/* ================================
   FINAL mobile overrides (put at VERY END of main.scss)
   Fix:
   - iPhone avatar centered
   - bio centered
   - contacts centered + NO white box
   - hamburger always visible on mobile
   ================================ */

@media (max-width: 768px) {

  /* --- 0) Make sidebar full-width on mobile (avoid left clipping) --- */
  .sidebar,
  .sidebar.sticky {
    float: none !important;
    width: 100% !important;
    max-width: 100% !important;
    margin: 0 auto !important;
  }

  /* --- 1) Avatar: force center + move UP (reduce top gap) --- */
  .sidebar .author__avatar,
  .sidebar.sticky .author__avatar {
    float: none !important;
    width: 100% !important;
    display: block !important;
    text-align: center !important;
    margin: 2px auto 10px !important; /* 往上移：调小第一个数，比如 6px */
  }

  .sidebar .author__avatar img,
  .sidebar.sticky .author__avatar img {
    display: block !important;
    margin: 0 auto !important;
    width: 180px !important;       /* 想更大：200px；更小：160px */
    max-width: 70vw !important;
    height: auto !important;
    border-radius: 50% !important;
  }

  /* --- 2) Hide duplicated author name (if you don't want it on mobile) --- */
  .sidebar .author__name,
  .sidebar.sticky .author__name {
    display: none !important;
  }

  /* --- 3) Bio centered --- */
  .sidebar .author__content,
  .sidebar.sticky .author__content {
    text-align: center !important;
  }

  .sidebar .author__bio,
  .sidebar.sticky .author__bio {
    text-align: center !important;
    margin: 10px auto 12px !important;
  }

  /* --- 4) Remove Follow button everywhere on mobile --- */
  .sidebar .author__urls-wrapper button,
  .sidebar .author__urls-wrapper .btn,
  .sidebar.sticky .author__urls-wrapper button,
  .sidebar.sticky .author__urls-wrapper .btn {
    display: none !important;
  }

  /* --- 5) Contacts: centered + remove white box/background/arrow --- */
  .sidebar .author__urls-wrapper,
  .sidebar.sticky .author__urls-wrapper {
    max-height: none !important;
    overflow: visible !important;
    text-align: center !important;
    background: transparent !important;
    border: 0 !important;
    box-shadow: none !important;
    padding: 0 !important;
    margin: 0 auto !important;
  }

  .sidebar .author__urls,
  .sidebar.sticky .author__urls {
    display: inline-flex !important;
    flex-wrap: wrap !important;
    justify-content: center !important;
    align-items: center !important;
    gap: 10px 18px !important;
    background: transparent !important; /* 干掉白框 */
    border: 0 !important;              /* 干掉白框 */
    box-shadow: none !important;       /* 干掉白框 */
    padding: 0 !important;
    margin: 0 auto !important;
  }

  .sidebar .author__urls li,
  .sidebar .author__urls a,
  .sidebar.sticky .author__urls li,
  .sidebar.sticky .author__urls a {
    background: transparent !important;
    border: 0 !important;
    box-shadow: none !important;
  }

  /* 某些主题会给 wrapper / urls 加 pseudo-element 做“气泡小尖角” */
  .sidebar .author__urls-wrapper:before,
  .sidebar .author__urls-wrapper:after,
  .sidebar .author__urls:before,
  .sidebar .author__urls:after,
  .sidebar.sticky .author__urls-wrapper:before,
  .sidebar.sticky .author__urls-wrapper:after,
  .sidebar.sticky .author__urls:before,
  .sidebar.sticky .author__urls:after {
    content: none !important;
    display: none !important;
  }

  /* --- 6) Hamburger: force show on mobile (Chrome emulation也会出现) --- */
  nav#site-nav.greedy-nav > button {
    display: block !important;
    visibility: visible !important;
    opacity: 1 !important;
  }

  /* dropdown panel not off-screen */
  nav#site-nav.greedy-nav .hidden-links {
    left: 0 !important;
    right: 0 !important;
    width: 100% !important;
    max-width: 100% !important;
    box-sizing: border-box !important;
    padding-left: 16px !important;
    padding-right: 16px !important;
  }
}
/* =========================================================
   FINAL DESKTOP FIXES (append at the VERY end of main.scss)
   1) Fix white blocks in desktop masthead nav
   2) Sidebar: avatar + bio centered, meta/links left-aligned
   ========================================================= */

/* ---------- 1) Desktop masthead: kill "white blocks" ---------- */
@media (min-width: 769px) {
  .masthead,
  .masthead__inner-wrap,
  .masthead__menu,
  .greedy-nav,
  .greedy-nav .visible-links,
  .greedy-nav .visible-links > li,
  .greedy-nav .visible-links > li > a {
    background: transparent !important;
    box-shadow: none !important;
  }

  /* If any rule accidentally set background-color (often white), force it off */
  .masthead__menu-item,
  .masthead__menu-item > a {
    background-color: transparent !important;
  }

  /* Ensure text is visible (not “white rectangle”) */
  .masthead a,
  .masthead a:visited {
    color: #ffffff !important;
  }

  /* Hover: bold only (no underline / no background) */
  .masthead a:hover {
    font-weight: 600 !important;
    background-color: transparent !important;
    text-decoration: none !important;
  }
}

/* ---------- 2) Desktop sidebar alignment rules ---------- */
@media (min-width: 769px) {
  /* Center the avatar block */
  .sidebar .author__avatar {
    float: none !important;
    display: flex !important;
    justify-content: center !important;
    margin: 0 0 10px 0 !important;
  }

  /* Center ONLY the bio line */
  .sidebar .author__bio {
    text-align: center !important;
    margin: 0 0 14px 0 !important;
  }

  /* Keep location/school + social links LEFT aligned */
  .sidebar .author__urls-wrapper,
  .sidebar .author__urls {
    text-align: left !important;
  }

  .sidebar .author__urls {
    display: block !important;
    padding-left: 0 !important;
    margin-left: 0 !important;
  }

  .sidebar .author__urls li {
    justify-content: flex-start !important;
  }

  .sidebar .author__urls a {
    justify-content: flex-start !important;
  }
}
